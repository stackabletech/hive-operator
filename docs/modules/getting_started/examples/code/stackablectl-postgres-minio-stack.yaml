---
stacks:
  minio-postgres:
    stackableRelease: empty
    description: Stack containing MinIO and PostgreSQL
    labels:
      - minio
      - postgresql
    manifests:
      - plainYaml: ./minio-certificates.yaml
      - helmChart:
          releaseName: minio
          name: minio
          repo:
            name: minio
            url: https://charts.min.io/
          version: 4.0.2
          options:
            rootUser: root
            rootPassword: rootroot
            mode: standalone
            users:
              - accessKey: hive
                secretKey: hivehive
                policy: readwrite
            buckets:
              - name: hive
                policy: public
            resources:
              requests:
                memory: 2Gi
            service:
              type: NodePort
              nodePort: null
            consoleService:
              type: NodePort
              nodePort: null
            tls:
              enabled: true
              certSecret: minio-tls-certificates
              publicCrt: tls.crt
              privateKey: tls.key
      - helmChart:
          releaseName: postgresql
          name: postgresql
          repo:
            name: bitnami
            url: https://charts.bitnami.com/bitnami/
          version: 10.16.2
          options:
            # Old version (10) of helm-charts has old way of setting credentials
            postgresqlUsername: hive
            postgresqlPassword: hive
            postgresqlDatabase: hive
